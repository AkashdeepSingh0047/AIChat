// Importing the OpenAI library to interact with the OpenAI API
import OpenAI from "openai";

// Asynchronous function that sends the user's message to the OpenAI API 
// and returns the AI-generated response.
export const getResponse = async (message) => {

    try {
        // Retrieve the API key from environment variables (Vite uses import.meta.env)
        const apiKey = import.meta.env.VITE_OPENAI_API_KEY

        // If API key is missing, throw an explicit error
        if (!apiKey) throw new Error("Provide Api Key.")
        
        // Create a new OpenAI client instance with the API key
        // 'dangerouslyAllowBrowser' enables browser-based usage (for frontend testing)
        const client = new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

        // Send the message to the model (gpt-5-nano) and await its response
        const res = await client.responses.create({
            model: "gpt-5-nano",   // The AI model to use
            input: message         // User input or prompt
        });

        // Return the text output generated by the model
        return res.output_text;

    } catch (error) {
        // If an error occurs (e.g., network issue or invalid key), throw it to be handled by caller
        throw error;
    }
}